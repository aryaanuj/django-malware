from django.shortcuts import render, HttpResponse, redirect
from django.contrib.auth.models import User
from django.contrib.auth import login, authenticate, logout
import requests
from home import API_KEY

def index(request):
    print(str(request.user.id))
    my_headers = {"Authorization" : "Bearer "+API_KEY}
    r = requests.get('http://127.0.0.1:8000/api/analyzed_data/?limit=7&user='+str(request.user.id), headers=my_headers)
    data = r.json()
    return render(request, 'home/index.html',{"analyzed_data":data})

def profile(request):
    return render(request, 'home/profile.html')

def report(request):
    return render(request, 'home/report.html')

def register(request):
    return render(request, 'home/register.html')

def logout_view(request):
    logout(request)
    return redirect('login')

def handler404(request, exception):
    return render('home/error_404.html')

# def handler500(request, exception):
    # return render('home/error_500.html')