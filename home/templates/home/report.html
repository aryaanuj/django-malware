{% extends 'core/layout/layout.html' %}
{%load static%}

{% block title %} REPORT {% endblock title %} 

{% block content %} 
  <section class="container-fluid" id="report-data">
    <div class="loading">
      <i class="fa fa-cog fa-spin" style="color:#200080 !important"></i>
      <br><br>
      <p class="loading-txt">Scanning....</p>
    </div>
    <div id="main-cont" style="display:none;">
      </div>
      <!-- tabs section  -->
      <div class="col-md-12 bg-white" id="analysis-overview" style="display:none;">
        <table class='table table-striped'><th style='border-left:10px solid #200080;'>Analysis Overview&nbsp;<i class='fa fa-info-circle text-info'></i></td></table>
          <nav>
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
              <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Structural Information</a>
              <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Behavioral Information</a>
            </div>
          </nav>
          <div class="tab-content" id="nav-tabContent" >
            <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab" >
              <table>
                <tbody>
                  <div id="structuralInfo" class="pl-4 pt-3"></div>
                </tbody>
              </table>
            </div>
            <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
              <table>
                <tbody>
                  <div id="behaviouralInfo" class="pl-4 pt-3"></div>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <!-- tabs section end -->
      </section>
      <?php
  //FOOTER CONTAINER (JS LINKS)
      require 'include/footer_container.php';
      ?>
      <script type="text/javascript">
        $(document).ready(function() {
          $(document).bind("contextmenu", function(t) {
            t.preventDefault();
          });
          var ts = 0, check = 0;
          var debugsize = 1, dll=1, exportsize=1, imageversion =1, ImportFunctionCount=1,ImportFunctionMethodCount=1, LinkerVersion=1, NumberOfSections=1, OsVersion=1, Dll_Loaded=1, FileOpened=1, Regkey_Written=1, Regkey_Read=1, Regkey_Opened=1, FileWritten=1, FileRead=1, FileCopied=1, Regkey_Deleted=1,Directory_Enumerated=1;
          var version=1,machine=1,entry_point_address=1,size_of_header=1,size_of_program_header=1,number_of_program_header=1,size_of_section_header=1,number_of_section_header=1,number_of_page=1,encrypt=1,number_of_object_streams=1,javascript=1,automatic_action=1,acroform=1,embedded_file=1,no_of_intent_category_entries=1,no_of_intent_action_entries=1,no_of_permission_entries=1,no_of_broadcast_reciever_entries=1,no_of_service_entries=1,open_action=1;
          setInterval(function() {
            ts += 1;
            var d = "<div id='basic-prop'>";
            d += "<table class='table table-striped'><th style='border-left:10px solid #200080;'>Basic Properties&nbsp;<i class='fa fa-info-circle text-info'></i></td></table>";
            d += "<table id='data-table'><tr>";
            var e = "", a = "";
            $.ajax({
              url: "search_script.php",
              method: "post",
              data: {
                report_hash: "<?=  $_GET['report_hash']; ?>",
                fcount: ts
              },
              success: function(t) {
                var l = JSON.parse(t);
                if (l.status) {
                  for (var r = 0; r < l.data.length; r += 1){
                    var n = l.data[r].Filetype;
                    if(n!=null){
                      check+=1;
                    }
                    if(check<=1){
                      $.ajax({
                        async:false,
                        url:"fetch_type.php",
                        method:"post",
                        data:{type:n},
                        success:function(data){
                          var objs = JSON.parse(data);
                          debugsize = objs.DebugSize;
                          dll = objs.DLL;
                          exportsize = objs.ExportSize;
                          imageversion = objs.ImageVersion;
                          ImportFunctionCount=objs.ImportFunctionCount;
                          ImportFunctionMethodCount=objs.ImportFunctionMethodCount;
                          LinkerVersion=objs.LinkerVersion;
                          NumberOfSections=objs.NumberOfSections;
                          OsVersion=objs.OsVersion;
                          Dll_Loaded=objs.Dll_Loaded;
                          FileOpened=objs.FileOpened;
                          Regkey_Written=objs.Regkey_Written;
                          Regkey_Read=objs.Regkey_Read;
                          Regkey_Opened=objs.Regkey_Opened;
                          FileWritten=objs.FileWritten;
                          FileRead=objs.FileRead;
                          FileCopied=objs.FileCopied;
                          Regkey_Deleted=objs.Regkey_Deleted;
                          Directory_Enumerated=objs.Directory_Enumerated;
                          version=objs.version;
                          machine=objs.machine;
                          entry_point_address=objs.entry_point_address;
                          size_of_header=objs.size_of_header;
                          size_of_program_header=objs.size_of_program_header;
                          number_of_program_header=objs.number_of_program_header;
                          size_of_section_header=objs.size_of_section_header;
                          number_of_section_header=objs.number_of_section_header;
                          number_of_page=objs.number_of_page;
                          encrypt=objs.encrypt;
                          number_of_object_streams=objs.number_of_object_streams;
                          javascript=objs.javascript;
                          automatic_action=objs.automatic_action;
                          acroform=objs.acroform;
                          embedded_file=objs.embedded_file;
                          no_of_intent_category_entries=objs.no_of_intent_category_entries;
                          no_of_intent_action_entries=objs.no_of_intent_action_entries;
                          no_of_permission_entries=objs.no_of_permission_entries;
                          no_of_broadcast_reciever_entries=objs.no_of_broadcast_reciever_entries;
                          no_of_service_entries=objs.no_of_service_entries;
                          open_action = objs.open_action;
                        }
                      });
                    }
                    d += "<tr>"; d += "<td>Filename </td>";
                    d += null != l.data[r].Filename ? "<td>" + l.data[r].Filename + "</td>" : "<td class='placeholder-item'></td>";
                    d += "</tr><tr>"; d += "<td>Filesize </td>"; d += null != l.data[r].Filesize ? "<td>" + l.data[r].Filesize + "</td>" : "<td class='placeholder-item'></td>";
                    d += "</tr><tr>"; d += "<td>Filetype </td>"; d += null != l.data[r].Filetype ? "<td>" + l.data[r].Filetype + "</td>" : "<td class='placeholder-item'></td>";
                    d += "</tr><tr>"; d += "<td>MD5 </td>"; d += null != l.data[r].MD5 ? "<td>" + l.data[r].MD5 + "</td>" : "<td class='placeholder-item'></td>";
                    d += "</tr><tr>"; d += "<td>SHA-1 </td>"; d += null != l.data[r].sha1 ? "<td>" + l.data[r].sha1 + "</td>" : "<td class='placeholder-item'></td>";
                    d += "</tr><tr>"; d += "<td>SHA-256 </td>"; d += null != l.data[r].sha256 ? "<td>" + l.data[r].sha256 + "</td>" : "<td class='placeholder-item'></td>";
                    d += "</tr><tr>"; d += "<td>SSDEEP </td>"; d += null != l.data[r].SSDeep ? "<td>" + l.data[r].SSdeep + "</td>" : "<td class='placeholder-item'></td>";
                    d += "</tr><tr>"; d += "<td>Magic </td>"; d += null != l.data[r].Magic ? "<td>" + l.data[r].Magic + "</td>" : "<td class='placeholder-item'></td>";
                    d += "</tr><tr>"; d += "<td>Scan Result </td>"; d += null != l.data[r].ScanResult ? "<td>" + l.data[r].ScanResult + "</td>" : "<td class='placeholder-item'></td>";
                    d += "</tr><tr>"; d += "<td>Malware Type </td>"; d += null != l.data[r].MalwareType ? "<td>" + l.data[r].MalwareType + "</td>" : "<td class='placeholder-item'></td>";
                    d += "</tr>"; d += "</table></div>";
                    if(debugsize==1){
                      e += "<tr>"; e += "<td>Debug Size</td>";
                      e += null != l.data[r].DebugSize ? "<td>" + l.data[r].DebugSize + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(dll==1){
                      e += "<tr>"; e += "<td>DLL</td>"; e += null != l.data[r].DLL ? "<td>" + l.data[r].DLL + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(exportsize==1){
                      e += "<tr>"; e += "<td>Export Size</td>"; e += null != l.data[r].ExportSize ? "<td>" + l.data[r].ExportSize + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(imageversion==1){
                      e += "<tr>"; e += "<td>Image Version</td>"; e += null != l.data[r].ImageVersion ? "<td>" + l.data[r].ImageVersion + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(ImportFunctionCount==1){
                      e += "<tr>"; e += "<td>Import Function Count</td>"; e += null != l.data[r].ImportFunctionCount ? "<td>" + l.data[r].ImportFunctionCount + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(ImportFunctionMethodCount==1){
                      e += "<tr>"; e += "<td>Import function Method Count</td>"; e += null != l.data[r].ImportFunctionMethodCount ? "<td>" + l.data[r].ImportFunctionMethodCount + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(LinkerVersion==1){
                      e += "<tr>"; e += "<td>Linker Version</td>"; e += null != l.data[r].LinkerVersion ? "<td>" + l.data[r].LinkerVersion + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(NumberOfSections==1){
                      e += "<tr>"; e += "<td>Number of Sections</td>"; e += null != l.data[r].NumberOfSections ? "<td>" + l.data[r].NumberOfSections + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(OsVersion==1){
                      e += "<tr>"; e += "<td>OS Version</td>"; e += null != l.data[r].OsVersion ? "<td>" + l.data[r].OsVersion + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(version==1){
                      e += "<tr>"; e += "<td>Version</td>"; e += null != l.data[r].version ? "<td>" + l.data[r].version + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(machine==1){
                      e += "<tr>"; e += "<td>Machine</td>"; e += null != l.data[r].machine ? "<td>" + l.data[r].machine + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(entry_point_address==1){
                      e += "<tr>"; e += "<td>Entry Point Address</td>"; e += null != l.data[r].entry_point_address ? "<td>" + l.data[r].entry_point_address + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(size_of_header==1){
                      e += "<tr>"; e += "<td>Size Of Header</td>"; e += null != l.data[r].size_of_header ? "<td>" + l.data[r].size_of_header + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(size_of_program_header==1){
                      e += "<tr>"; e += "<td>Size Of Program Header</td>"; e += null != l.data[r].size_of_program_header ? "<td>" + l.data[r].size_of_program_header + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(number_of_program_header==1){
                      e += "<tr>"; e += "<td>No Of Program Header</td>"; e += null != l.data[r].number_of_program_header ? "<td>" + l.data[r].number_of_program_header + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(size_of_section_header==1){
                      e += "<tr>"; e += "<td>Size Of Section Header</td>"; e += null != l.data[r].size_of_section_header ? "<td>" + l.data[r].size_of_section_header + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(number_of_section_header==1){
                      e += "<tr>"; e += "<td>No Of Section Header</td>"; e += null != l.data[r].number_of_section_header ? "<td>" + l.data[r].number_of_section_header + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(number_of_page==1){
                      e += "<tr>"; e += "<td>No Of Page</td>"; e += null != l.data[r].number_of_page ? "<td>" + l.data[r].number_of_page + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(encrypt==1){
                      e += "<tr>"; e += "<td>Encrypt</td>"; e += null != l.data[r].encrypt ? "<td>" + l.data[r].encrypt + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(number_of_object_streams==1){
                      e += "<tr>"; e += "<td>No Of Object Streams</td>"; e += null != l.data[r].number_of_object_streams ? "<td>" + l.data[r].number_of_object_streams + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }

                    if(javascript==1){
                      e += "<tr>"; e += "<td>Javascript</td>"; e += null != l.data[r].javascript ? "<td>" + l.data[r].javascript + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(automatic_action==1){
                      e += "<tr>"; e += "<td>Automatic Action</td>"; e += null != l.data[r].automatic_action ? "<td>" + l.data[r].automatic_action + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(acroform==1){
                      e += "<tr>"; e += "<td>Acroform</td>"; e += null != l.data[r].acroform ? "<td>" + l.data[r].acroform + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(embedded_file==1){
                      e += "<tr>"; e += "<td>Embedded File</td>"; e += null != l.data[r].embedded_file ? "<td>" + l.data[r].embedded_file + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(no_of_intent_category_entries==1){
                      e += "<tr>"; e += "<td>No Of Intent Category Entries</td>"; e += null != l.data[r].no_of_intent_category_entries ? "<td>" + l.data[r].no_of_intent_category_entries + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(no_of_intent_action_entries==1){
                      e += "<tr>"; e += "<td>No Of Intent Action Entries</td>"; e += null != l.data[r].no_of_intent_action_entries ? "<td>" + l.data[r].no_of_intent_action_entries + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(no_of_permission_entries==1){
                      e += "<tr>"; e += "<td>No Of Permission Entries</td>"; e += null != l.data[r].no_of_permission_entries ? "<td>" + l.data[r].no_of_permission_entries + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }

                    if(no_of_broadcast_reciever_entries==1){
                      e += "<tr>"; e += "<td>No Of Broadcast Reciever Entries</td>"; e += null != l.data[r].no_of_broadcast_reciever_entries ? "<td>" + l.data[r].no_of_broadcast_reciever_entries + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(no_of_service_entries==1){
                      e += "<tr>"; e += "<td>No Of Service Entries</td>"; e += null != l.data[r].no_of_service_entries ? "<td>" + l.data[r].no_of_service_entries + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(open_action==1){
                      e += "<tr>"; e += "<td>Open Action</td>"; e += null != l.data[r].open_action ? "<td>" + l.data[r].open_action + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }

                    if(Dll_Loaded==1){
                      a += "<tr>"; a += "<td>Number Of Dll Loaded</td>"; a += null != l.data[r].Dll_Loaded ? "<td>" + l.data[r].Dll_Loaded + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(FileOpened==1){
                      a += "<tr>"; a += "<td>Number Of File Opened</td>"; a += null != l.data[r].FileOpened ? "<td>" + l.data[r].FileOpened + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(Regkey_Written==1){
                      a += "<tr>"; a += "<td>Number Of RegKey Written</td>"; a += null != l.data[r].Regkey_Written ? "<td>" + l.data[r].Regkey_Written + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(Regkey_Read==1){
                      a += "<tr>"; a += "<td>Number Of RegKey Read</td>"; a += null != l.data[r].Regkey_Read ? "<td>" + l.data[r].Regkey_Read + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(Regkey_Opened==1){
                      a += "<tr>"; a += "<td>Number Of RegKey Opened</td>"; a += null != l.data[r].Regkey_Opened ? "<td>" + l.data[r].Regkey_Opened + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(FileWritten==1){
                      a += "<tr>"; a += "<td>Number Of File Written</td>"; a += null != l.data[r].FileWritten ? "<td>" + l.data[r].FileWritten + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(FileRead==1){
                      a += "<tr>"; a += "<td>Number Of File Read</td>"; a += null != l.data[r].FileRead ? "<td>" + l.data[r].FileRead + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(FileCopied==1){
                      a += "<tr>"; a += "<td>Number Of File Copied</td>"; a += null != l.data[r].FileCopied ? "<td>" + l.data[r].FileCopied + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(Regkey_Deleted==1){
                      a += "<tr>"; a += "<td>Number Of RegKey Deleted</td>"; a += null != l.data[r].Regkey_Deleted ? "<td>" + l.data[r].Regkey_Deleted + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                    if(Directory_Enumerated==1){
                      a += "<tr>"; a += "<td>Number Of Directory Enumerated</td>"; a += null != l.data[r].Directory_Enumerated ? "<td>" + l.data[r].Directory_Enumerated + "</td>" : "<td class='placeholder-item'></td></tr>";
                    }
                  }
                  $("#analysis-overview").show();
                } else{ d = ""; d = "<div id='basic-prop'>"; d += "<table class='table text-center'><th style='color:red;font-size:20px;' class='p-5'><i class='fa fa-warning fa-5x'></i><br><br> " + l.Error[0].message + "</td></table>";
                $("#analysis-overview").hide();
              }
              $("#main-cont").show(), $("#main-cont").html(d), $("#structuralInfo").html(e), $("#behaviouralInfo").html(a),
              $(".loading").hide();
            }
          });
}, 3000);
});
</script>
{% endblock content %}