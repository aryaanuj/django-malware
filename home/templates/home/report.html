{% extends 'core/layout/layout.html' %}
{%load static%}

{% block title %} REPORT {% endblock title %} 

{% block content %} 
  <section class="container-fluid pb-5 mb-5" style="height: auto;">
    <div class="loading" style="display:none;">
      <i class="fa fa-cog fa-spin" style="color:#200080 !important"></i>
      <br><br>
      <p class="loading-txt">SCANNING...</p>
    </div>
    <div id="main-cont" >
      </div>
      <!-- tabs section  -->
      <div class="col-md-12 bg-white" id="analysis-overview" style="display:none;">
        <table class='table table-striped'><th style='border-left:10px solid #200080;'>Analysis Overview&nbsp;<i class='fa fa-info-circle text-info'></i></th></table>
          <nav>
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
              <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Structural Information</a>
              <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Behavioral Information</a>
            </div>
          </nav>
          <div class="tab-content" id="nav-tabContent" >
            <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab" >
              <table>
                <tbody>
                  <div id="structuralInfo" class="pl-4 pt-3"></div>
                </tbody>
              </table>
            </div>
            <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
              <table>
                <tbody>
                  <div id="behaviouralInfo" class="pl-4 pt-3"></div>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <!-- tabs section end -->
      </section>
     
    
{% endblock content %}
{%block script%}
  <script type="text/javascript">
    $(document).ready(function() {
      // $(document).bind("contextmenu", function(t) {
      //   t.preventDefault();
      // });
      var ts = 0, check = 0;
      var debugsize = false, dll=false, exportsize=false, imageversion =false, importfunctioncount=false,importfunctionmethodcount=false, linkerversion=false, numberofsections=false, osversion=false, dll_loaded=false, fileopened=false, regkey_written=false, regkey_read=false, regkey_opened=false, filewritten=false, fileread=false, filecopied=false, regkey_deleted=false,directory_enumerated=false;
      var version=false,machine=false,entry_point_address=false,size_of_header=false,size_of_program_header=false,number_of_program_header=false,size_of_section_header=false,number_of_section_header=false,number_of_page=false,encrypt=false,number_of_object_streams=false,javascript=false,automatic_action=false,acroform=false,embedded_file=false,no_of_intent_category_entries=false,no_of_intent_action_entries=false,no_of_permission_entries=false,no_of_broadcast_reciever_entries=false,no_of_service_entries=false,open_action=false;
      // const api_interval = setInterval(function() {
        ts += 1;
        var d = "<div id='basic-prop'>";
        d += "<table class='table table-striped'><th style='border-left:10px solid #200080;'>Basic Properties&nbsp;<i class='fa fa-info-circle text-info'></i></td></table>";
        d += "<table id='data-table'><tr>";
        var e = "", a = "";
        axios({
          method:"get",
          url: "{{BASE_URL}}analyzed_data/{{report_hash}}",
          headers: {'Content-Type': 'application/json;charset=UTF-8','Authorization': 'Bearer {{request.session.API_TOKEN}}'}
        }).then((response) =>{
              response = response.data;
              $("#main-cont").html(d);
              const tree = JsonView.createTree(response);
              JsonView.render(tree, document.querySelector('#basic-prop'));
              // expand tree
              JsonView.expandChildren(tree);
              //     if(!response){
              //         d = ""; d = "<div id='basic-prop'>"; d += "<table class='table text-center'><th style='color:red;font-size:20px;' class='p-5'><i class='fa fa-warning fa-5x'></i><br><br> Data Not Found</td></table>";
              //         clearInterval(api_interval);
              //       }
              //       var n = response.filetype;
              //       if(n!=null){
              //         check+=1;
              //       }
              //       if(check<=1){
              //         $.ajax({
              //           async:false,
              //           url:"{{BASE_URL}}analyzed_field_view/?filetype="+n,
              //           headers: {'Authorization': 'Bearer {{request.session.API_TOKEN}}', 'Content-Type': 'application/json;charset=UTF-8'},
              //           method:"GET",
              //           success:function(objs){
                       
              //             if(objs.length>0){
              //             debugsize = objs[0].debugsize;
              //             dll = objs[0].dll;
              //             exportsize = objs[0].exportsize;
              //             imageversion = objs[0].imageversion;
              //             importfunctioncount=objs[0].importfunctioncount;
              //             importfunctionmethodcount=objs[0].importfunctionmethodcount;
              //             linkerversion=objs[0].linkerversion;
              //             numberofsections=objs[0].numberofsections;
              //             osversion=objs[0].osversion;
              //             dll_loaded=objs[0].dll_loaded;
              //             fileopened=objs[0].fileopened;
              //             regkey_written=objs[0].regkey_written;
              //             regkey_read=objs[0].regkey_read;
              //             regkey_opened=objs[0].regkey_opened;
              //             filewritten=objs[0].filewritten;
              //             fileread=objs[0].fileread;
              //             filecopied=objs[0].filecopied;
              //             regkey_deleted=objs[0].regkey_deleted;
              //             directory_enumerated=objs[0].directory_enumerated;
              //             version=objs[0].version;
              //             machine=objs[0].machine;
              //             entry_point_address=objs[0].entry_point_address;
              //             size_of_header=objs[0].size_of_header;
              //             size_of_program_header=objs[0].size_of_program_header;
              //             number_of_program_header=objs[0].number_of_program_header;
              //             size_of_section_header=objs[0].size_of_section_header;
              //             number_of_section_header=objs[0].number_of_section_header;
              //             number_of_page=objs[0].number_of_page;
              //             encrypt=objs[0].encrypt;
              //             number_of_object_streams=objs[0].number_of_object_streams;
              //             javascript=objs[0].javascript;
              //             automatic_action=objs[0].automatic_action;
              //             acroform=objs[0].acroform;
              //             embedded_file=objs[0].embedded_file;
              //             no_of_intent_category_entries=objs[0].no_of_intent_category_entries;
              //             no_of_intent_action_entries=objs[0].no_of_intent_action_entries;
              //             no_of_permission_entries=objs[0].no_of_permission_entries;
              //             no_of_broadcast_reciever_entries=objs[0].no_of_broadcast_reciever_entries;
              //             no_of_service_entries=objs[0].no_of_service_entries;
              //             open_action = objs[0].open_action;
              //           }
              //           }
              //         });
              //       }
              //       d += "<tr>"; d += "<td>Filename </td>";
              //       d += null != response.filename ? "<td>" + response.filename + "</td>" : "<td class='placeholder-item'></td>";
              //       d += "</tr><tr>"; d += "<td>Filesize </td>"; d += null != response.filesize ? "<td>" + response.filesize + "</td>" : "<td class='placeholder-item'></td>";
              //       d += "</tr><tr>"; d += "<td>Filetype </td>"; d += null != response.filetype ? "<td>" + response.filetype + "</td>" : "<td class='placeholder-item'></td>";
              //       d += "</tr><tr>"; d += "<td>MD5 </td>"; d += null != response.md5 ? "<td>" + response.md5 + "</td>" : "<td class='placeholder-item'></td>";
              //       d += "</tr><tr>"; d += "<td>SHA-1 </td>"; d += null != response.sha1 ? "<td>" + response.sha1 + "</td>" : "<td class='placeholder-item'></td>";
              //       d += "</tr><tr>"; d += "<td>SHA-256 </td>"; d += null != response.sha256 ? "<td>" + response.sha256 + "</td>" : "<td class='placeholder-item'></td>";
              //       d += "</tr><tr>"; d += "<td>SSDEEP </td>"; d += null != response.ssdeep ? "<td>" + response.ssdeep + "</td>" : "<td class='placeholder-item'></td>";
              //       d += "</tr><tr>"; d += "<td>Magic </td>"; d += null != response.magic ? "<td>" + response.magic + "</td>" : "<td class='placeholder-item'></td>";
              //       d += "</tr><tr>"; d += "<td>Scan Result </td>"; d += null != response.scan_result ? "<td>" + response.scan_result + "</td>" : "<td class='placeholder-item'></td>";
              //       d += "</tr><tr>"; d += "<td>Malware Type </td>"; d += null != response.malware_type ? "<td>" + response.malware_type + "</td>" : "<td class='placeholder-item'></td>";
              //       d += "</tr>"; d += "</table></div>";
              //       if(debugsize==true){
              //         e += "<tr>"; e += "<td>Debug Size</td>";
              //         e += null != response.debugsize ? "<td>" + response.debugsize + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(dll==true){
              //         e += "<tr>"; e += "<td>DLL</td>"; e += null != response.dll ? "<td>" + response.dll + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(exportsize==true){
              //         e += "<tr>"; e += "<td>Export Size</td>"; e += null != response.exportsize ? "<td>" + response.exportsize + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(imageversion==true){
              //         e += "<tr>"; e += "<td>Image Version</td>"; e += null != response.imageversion ? "<td>" + response.imageversion + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(importfunctioncount==true){
              //         e += "<tr>"; e += "<td>Import Function Count</td>"; e += null != response.importfunctioncount ? "<td>" + response.importfunctioncount + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(importfunctionmethodcount==true){
              //         e += "<tr>"; e += "<td>Import function Method Count</td>"; e += null != response.importfunctionmethodcount ? "<td>" + response.importfunctionmethodcount + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(linkerversion==true){
              //         e += "<tr>"; e += "<td>Linker Version</td>"; e += null != response.linkerversion ? "<td>" + response.linkerversion + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(numberofsections==true){
              //         e += "<tr>"; e += "<td>Number of Sections</td>"; e += null != response.numberofsections ? "<td>" + response.numberofsections + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(osversion==true){
              //         e += "<tr>"; e += "<td>OS Version</td>"; e += null != response.osversion ? "<td>" + response.osversion + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(version==true){
              //         e += "<tr>"; e += "<td>Version</td>"; e += null != response.version ? "<td>" + response.version + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(machine==true){
              //         e += "<tr>"; e += "<td>Machine</td>"; e += null != response.machine ? "<td>" + response.machine + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(entry_point_address==true){
              //         e += "<tr>"; e += "<td>Entry Point Address</td>"; e += null != response.entry_point_address ? "<td>" + response.entry_point_address + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(size_of_header==true){
              //         e += "<tr>"; e += "<td>Size Of Header</td>"; e += null != response.size_of_header ? "<td>" + response.size_of_header + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(size_of_program_header==true){
              //         e += "<tr>"; e += "<td>Size Of Program Header</td>"; e += null != response.size_of_program_header ? "<td>" + response.size_of_program_header + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(number_of_program_header==true){
              //         e += "<tr>"; e += "<td>No Of Program Header</td>"; e += null != response.number_of_program_header ? "<td>" + response.number_of_program_header + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(size_of_section_header==true){
              //         e += "<tr>"; e += "<td>Size Of Section Header</td>"; e += null != response.size_of_section_header ? "<td>" + response.size_of_section_header + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(number_of_section_header==true){
              //         e += "<tr>"; e += "<td>No Of Section Header</td>"; e += null != response.number_of_section_header ? "<td>" + response.number_of_section_header + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(number_of_page==true){
              //         e += "<tr>"; e += "<td>No Of Page</td>"; e += null != response.number_of_page ? "<td>" + response.number_of_page + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(encrypt==true){
              //         e += "<tr>"; e += "<td>Encrypt</td>"; e += null != response.encrypt ? "<td>" + response.encrypt + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(number_of_object_streams==true){
              //         e += "<tr>"; e += "<td>No Of Object Streams</td>"; e += null != response.number_of_object_streams ? "<td>" + response.number_of_object_streams + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }

              //       if(javascript==true){
              //         e += "<tr>"; e += "<td>Javascript</td>"; e += null != response.javascript ? "<td>" + response.javascript + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(automatic_action==true){
              //         e += "<tr>"; e += "<td>Automatic Action</td>"; e += null != response.automatic_action ? "<td>" + response.automatic_action + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(acroform==true){
              //         e += "<tr>"; e += "<td>Acroform</td>"; e += null != response.acroform ? "<td>" + response.acroform + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(embedded_file==true){
              //         e += "<tr>"; e += "<td>Embedded File</td>"; e += null != response.embedded_file ? "<td>" + response.embedded_file + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(no_of_intent_category_entries==true){
              //         e += "<tr>"; e += "<td>No Of Intent Category Entries</td>"; e += null != response.no_of_intent_category_entries ? "<td>" + response.no_of_intent_category_entries + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(no_of_intent_action_entries==true){
              //         e += "<tr>"; e += "<td>No Of Intent Action Entries</td>"; e += null != response.no_of_intent_action_entries ? "<td>" + response.no_of_intent_action_entries + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(no_of_permission_entries==true){
              //         e += "<tr>"; e += "<td>No Of Permission Entries</td>"; e += null != response.no_of_permission_entries ? "<td>" + response.no_of_permission_entries + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }

              //       if(no_of_broadcast_reciever_entries==true){
              //         e += "<tr>"; e += "<td>No Of Broadcast Reciever Entries</td>"; e += null != response.no_of_broadcast_reciever_entries ? "<td>" + response.no_of_broadcast_reciever_entries + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(no_of_service_entries==true){
              //         e += "<tr>"; e += "<td>No Of Service Entries</td>"; e += null != response.no_of_service_entries ? "<td>" + response.no_of_service_entries + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(open_action==true){
              //         e += "<tr>"; e += "<td>Open Action</td>"; e += null != response.open_action ? "<td>" + response.open_action + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }

              //       if(dll_loaded==true){
              //         a += "<tr>"; a += "<td>Number Of Dll Loaded</td>"; a += null != response.dll_loaded ? "<td>" + response.dll_loaded + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(fileopened==true){
              //         a += "<tr>"; a += "<td>Number Of File Opened</td>"; a += null != response.fileopened ? "<td>" + response.fileopened + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(regkey_written==true){
              //         a += "<tr>"; a += "<td>Number Of RegKey Written</td>"; a += null != response.regkey_written ? "<td>" + response.regkey_written + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(regkey_read==true){
              //         a += "<tr>"; a += "<td>Number Of RegKey Read</td>"; a += null != response.regkey_read ? "<td>" + response.regkey_read + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(regkey_opened==true){
              //         a += "<tr>"; a += "<td>Number Of RegKey Opened</td>"; a += null != response.regkey_opened ? "<td>" + response.regkey_opened + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(filewritten==true){
              //         a += "<tr>"; a += "<td>Number Of File Written</td>"; a += null != response.filewritten ? "<td>" + response.filewritten + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(fileread==true){
              //         a += "<tr>"; a += "<td>Number Of File Read</td>"; a += null != response.fileread ? "<td>" + response.fileread + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(filecopied==true){
              //         a += "<tr>"; a += "<td>Number Of File Copied</td>"; a += null != response.filecopied ? "<td>" + response.filecopied + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(regkey_deleted==true){
              //         a += "<tr>"; a += "<td>Number Of RegKey Deleted</td>"; a += null != response.regkey_deleted ? "<td>" + response.regkey_deleted + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //       if(directory_enumerated==true){
              //         a += "<tr>"; a += "<td>Number Of Directory Enumerated</td>"; a += null != response.directory_enumerated ? "<td>" + response.directory_enumerated + "</td>" : "<td class='placeholder-item'></td></tr>";
              //       }
              //     $("#analysis-overview").show();
              //   if (response.status=='complete') {
              //     clearInterval(api_interval);
              //   }
              // $("#main-cont").show();
              // $("#main-cont").html(d);
              // $("#structuralInfo").html(e);
              // $("#behaviouralInfo").html(a);
              // $(".loading").hide();
        }).catch(err =>{
          console.log(err);
          d = ""; d = "<div id='basic-prop'>"; d += "<table class='table text-center'><th style='color:red;font-size:20px;' class='p-5'><i class='fa fa-warning fa-5x'></i><br><br> Data Not Found</td></table>";
          clearInterval(api_interval);
          $("#main-cont").show();
              $("#main-cont").html(d);
              $("#structuralInfo").html(e);
              $("#behaviouralInfo").html(a);
              $(".loading").hide();
        }); //catch

      // }, 1000); //setInterval
    }); //ready document
</script>
{%endblock script%}